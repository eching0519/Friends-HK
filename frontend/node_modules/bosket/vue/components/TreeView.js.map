{"version":3,"sources":["../../../src/vue/components/TreeView.js"],"names":["object","tree","RootNode","defaults","TreeViewNode","combine","withLabels","withListener","TreeViewBase","name","props","data","searchInput","filtered","methods","onSearch","evt","input","currentTarget","value","$data","trim","$props","model","category","treeFilter","search","computed","computedModel","sort","wrapDragNDrop","rootNode","created","_props","get","filter","prop","_outputs","onSelect","onDrag","dragndrop","drag","onOver","over","onEnter","enter","onLeave","leave","onDrop","drop","onCancel","cancel","_state","set","key","s","$forceUpdate","mounted","keyUpListener","subscribe","onKey","keyDownListener","render","rest","filteredModel","ancestors","folded","searched","searchBar","labels","mixCss","TreeView","eventType","autoMount"],"mappings":"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","file":"TreeView.js","sourcesContent":["import { object, tree } from \"../../tools\"\nimport { RootNode, defaults } from \"../../core\"\nimport { TreeViewNode } from \"./TreeViewNode\"\nimport { combine, withLabels, withListener } from \"../traits\"\n\nconst TreeViewBase = {\n    name: \"TreeView\",\n    props: [ \"model\", \"category\", \"selection\", \"onSelect\", \"display\", \"search\", \"transition\",\n        \"strategies\", \"labels\", \"css\", \"dragndrop\", \"sort\", \"disabled\", \"noOpener\", \"async\",\n        \"keyUpListener\", \"keyDownListener\", \"unique\" ],\n    data: () => ({\n        searchInput: \"\",\n        filtered: null\n    }),\n    methods: {\n        onSearch(evt) {\n            const input = evt.currentTarget.value\n            this.$data.searchInput = input\n            this.$data.filtered = !input.trim() ? null :\n                tree(this.$props.model, this.$props.category)\n                    .treeFilter(this.$props.search(input.trim()))\n        }\n    },\n    computed: {\n        computedModel() {\n            return this.$props.sort ?\n                this.$props.model.sort(this.$props.sort) :\n                this.$props.model\n        },\n        wrapDragNDrop() { return this.rootNode.wrapDragNDrop() }\n    },\n    created() {\n        const _props = {\n            get: () => ({\n                ...defaults,\n                ...object(this.$props).filter(prop => !!prop)\n            })\n        }\n        const _outputs = {\n            onSelect:   this.$props.onSelect,\n            onDrag:     this.$props.dragndrop && this.$props.dragndrop.drag,\n            onOver:     this.$props.dragndrop && this.$props.dragndrop.over,\n            onEnter:    this.$props.dragndrop && this.$props.dragndrop.enter,\n            onLeave:    this.$props.dragndrop && this.$props.dragndrop.leave,\n            onDrop:     this.$props.dragndrop && this.$props.dragndrop.drop,\n            onCancel:   this.$props.dragndrop && this.$props.dragndrop.cancel\n        }\n        const _state = {\n            get: () => ({ ...this.$data }),\n            set: s => {\n                for(const key in s) {\n                    if(key in this.$data) this.$data[key] = s[key]\n                }\n            }\n        }\n        this.rootNode = new RootNode(\n            _props,\n            _outputs,\n            _state,\n            this.$forceUpdate\n        )\n    },\n    mounted() {\n        this.keyUpListener.subscribe(this.rootNode.onKey)\n        this.keyDownListener.subscribe(this.rootNode.onKey)\n    },\n    render() {\n        const { onSelect, sort, model, ...rest } = object(this.$props).filter(prop => !!prop)\n        const data = {\n            props: {\n                ...defaults,\n                ...rest,\n                model: this.computedModel,\n                filteredModel: this.$data.filtered,\n                onSelect: this.rootNode.onSelect,\n                dragndrop: this.wrapDragNDrop,\n                ancestors: [],\n                sort: sort,\n                folded: false,\n                searched: !!this.$data.searchInput.trim()\n            }\n        }\n\n        const searchBar = !this.$props.search ? null :\n            <input\n                type=\"search\"\n                class={ this.rootNode.mixCss(\"search\") }\n                value={ this.$data.searchInput }\n                placeholder={ this.$props.labels && this.$props.labels[\"search.placeholder\"] }\n                onInput={ this.onSearch } />\n\n        return (\n            <div class={ this.rootNode.mixCss(\"TreeView\") }>\n                { searchBar }\n                <TreeViewNode { ...data } />\n            </div>\n        )\n    }\n}\n\nexport const TreeView = combine(\n    withLabels(defaults.labels),\n    withListener({ eventType: \"keyup\", prop: \"keyUpListener\", autoMount: true }),\n    withListener({ eventType: \"keydown\", prop: \"keyDownListener\", autoMount: true })\n)(TreeViewBase)\n"]}