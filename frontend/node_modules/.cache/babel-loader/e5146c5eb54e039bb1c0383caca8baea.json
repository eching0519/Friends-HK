{"ast":null,"code":"import React from 'react';\n\nconst querystring = require('querystring');\n\nconst LoginVerifier = async props => {\n  if (props.user === null) {\n    window.location.replace(\"/login\");\n    return;\n  }\n\n  let myUser = JSON.parse(sessionStorage.getItem('UserProfile'));\n  let url = '/checkSession';\n  let res = await fetch(url, {\n    method: 'GET'\n  });\n  let data;\n  var msgUrl;\n\n  try {\n    data = await res.json();\n  } catch (error) {\n    msgUrl = querystring.encode({\n      smsg: 'Error!',\n      msg: \"Unexpected error. (\".concat(error.message, \")\")\n    });\n    window.location.replace(\"/login?\" + msgUrl);\n    return;\n  }\n\n  const loginVerification = data.verification;\n\n  if (loginVerification) {\n    if (loginVerification.email !== myUser.email && loginVerification.verified) {\n      msgUrl = querystring.encode({\n        smsg: 'Sorry!',\n        msg: \"Session is invalid. Please login again.\"\n      });\n      window.location.replace(\"/login?\" + msgUrl);\n      return;\n    }\n  }\n};\n\nexport default LoginVerifier;","map":{"version":3,"sources":["Z:\\3100project\\Friends-HK\\frontend\\src\\app\\component\\common\\LoginVerifier.js"],"names":["React","querystring","require","LoginVerifier","props","user","window","location","replace","myUser","JSON","parse","sessionStorage","getItem","url","res","fetch","method","data","msgUrl","json","error","encode","smsg","msg","message","loginVerification","verification","email","verified"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;;AACA,MAAMC,WAAW,GAAGC,OAAO,CAAC,aAAD,CAA3B;;AAEA,MAAMC,aAAa,GAAG,MAAOC,KAAP,IAAiB;AAEnC,MAAIA,KAAK,CAACC,IAAN,KAAe,IAAnB,EAAyB;AACrBC,IAAAA,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwB,QAAxB;AACA;AACH;;AAED,MAAIC,MAAM,GAAGC,IAAI,CAACC,KAAL,CAAWC,cAAc,CAACC,OAAf,CAAuB,aAAvB,CAAX,CAAb;AAEA,MAAIC,GAAG,GAAG,eAAV;AACE,MAAIC,GAAG,GAAG,MAAMC,KAAK,CAACF,GAAD,EAAM;AACvBG,IAAAA,MAAM,EAAE;AADe,GAAN,CAArB;AAIA,MAAIC,IAAJ;AACA,MAAIC,MAAJ;;AACA,MAAI;AACAD,IAAAA,IAAI,GAAG,MAAMH,GAAG,CAACK,IAAJ,EAAb;AACH,GAFD,CAEE,OAAOC,KAAP,EAAc;AACVF,IAAAA,MAAM,GAAGlB,WAAW,CAACqB,MAAZ,CAAmB;AAACC,MAAAA,IAAI,EAAC,QAAN;AAAgBC,MAAAA,GAAG,+BAAwBH,KAAK,CAACI,OAA9B;AAAnB,KAAnB,CAAT;AACAnB,IAAAA,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwB,YAAYW,MAApC;AACA;AACL;;AAED,QAAMO,iBAAiB,GAAGR,IAAI,CAACS,YAA/B;;AACA,MAAID,iBAAJ,EAAuB;AACnB,QAAIA,iBAAiB,CAACE,KAAlB,KAA4BnB,MAAM,CAACmB,KAAnC,IAA4CF,iBAAiB,CAACG,QAAlE,EAA4E;AACtEV,MAAAA,MAAM,GAAGlB,WAAW,CAACqB,MAAZ,CAAmB;AAACC,QAAAA,IAAI,EAAC,QAAN;AAAgBC,QAAAA,GAAG;AAAnB,OAAnB,CAAT;AACAlB,MAAAA,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwB,YAAYW,MAApC;AACA;AACL;AACJ;AACN,CAhCD;;AAkCA,eAAehB,aAAf","sourcesContent":["import React from 'react';\r\nconst querystring = require('querystring');\r\n\r\nconst LoginVerifier = async (props) => {\r\n\r\n    if (props.user === null) {\r\n        window.location.replace(\"/login\");\r\n        return\r\n    }\r\n\r\n    let myUser = JSON.parse(sessionStorage.getItem('UserProfile'));\r\n    \r\n    let url = '/checkSession';\r\n      let res = await fetch(url, {\r\n          method: 'GET',\r\n      });\r\n\r\n      let data;\r\n      var msgUrl;\r\n      try {\r\n          data = await res.json();\r\n      } catch (error) {\r\n            msgUrl = querystring.encode({smsg:'Error!', msg: `Unexpected error. (${error.message})`})\r\n            window.location.replace(\"/login?\" + msgUrl);\r\n            return\r\n      }\r\n\r\n      const loginVerification = data.verification;\r\n      if (loginVerification) {\r\n          if (loginVerification.email !== myUser.email && loginVerification.verified) {\r\n                msgUrl = querystring.encode({smsg:'Sorry!', msg: `Session is invalid. Please login again.`})\r\n                window.location.replace(\"/login?\" + msgUrl);\r\n                return\r\n          }\r\n      }\r\n}\r\n\r\nexport default LoginVerifier;"]},"metadata":{},"sourceType":"module"}